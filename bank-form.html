<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bank Transfer</title>
<style>
body { font-family: 'Segoe UI', sans-serif; background: #f4f6f9; margin:0; padding:20px; display:flex; justify-content:center; }
.container { background:#fff; padding:30px; border-radius:20px; box-shadow:0 10px 30px rgba(0,0,0,0.1); max-width:900px; width:100%; }
h2 { text-align:center; color:#007bff; margin-bottom:20px; }
.bank-select-wrapper { display:flex; justify-content:center; align-items:center; gap:15px; margin-bottom:25px; padding:15px; border-radius:15px; border:1px solid #cce0ff; background:#f0f7ff; flex-wrap:wrap; }
.bank-select-wrapper select { padding:12px 15px; border-radius:12px; border:1px solid #007bff; font-size:15px; min-width:200px; }
.bank-logo { max-height:50px; display:none; border-radius:8px; }
.row { display:flex; flex-wrap:wrap; gap:20px; }
.col { flex:1; min-width:280px; background:#f9f9f9; padding:20px; border-radius:12px; box-shadow:inset 0 0 10px rgba(0,0,0,0.03); }
label { font-weight:600; display:block; margin-top:10px; font-size:14px; color:#444; }
input { width:100%; padding:12px; margin-top:6px; border:1px solid #ccc; border-radius:10px; font-size:14px; }
input:focus, select:focus { border-color:#007bff; box-shadow:0 0 8px rgba(0,123,255,0.2); }
.transaction-box { display:grid; grid-template-columns:repeat(2,1fr); gap:15px; margin-top:20px; }
.transaction-box input[readonly] { background:#e9f1ff; }
.rate-display { text-align:center; font-weight:bold; font-size:16px; color:#007bff; margin:20px 0; }
button { margin-top:25px; width:100%; padding:16px; background:#007bff; color:#fff; border:none; border-radius:12px; font-size:16px; font-weight:600; cursor:pointer; transition:0.3s; }
button:hover { background:#0056b3; }
@media(max-width:768px){ .row{ flex-direction:column; } .transaction-box{ grid-template-columns:1fr; } }
</style>
</head>
<body>
<div class="container">
<h2>🏦 Bank Account Transfer - ဘဏ်အကောင့်ငွေလွှဲခြင်း။</h2>

<div class="bank-select-wrapper">
  <select id="bankSelect" onchange="showBankLogo()" required>
    <option value="">-- Select Bank - ဘဏ်ကိုရွေးပါ။ --</option>
    <option value="KBZ Bank">KBZ Bank</option>
    <option value="CB Bank">CB Bank</option>
    <option value="Yoma Bank">Yoma Bank</option>
    <option value="AYA Bank">AYA Bank</option>
  </select>
  <img id="bankLogo" class="bank-logo" alt="Bank Logo">
</div>

<div class="row">
  <div class="col">
    <h3>👤 Sender Details</h3>
    <label for="senderName">Sender Name - ပေးပို့သူအမည်</label>
    <input type="text" id="senderName" placeholder="Enter sender's full name" required>
    <label for="senderPhone">Sender Phone - ပေးပို့သူ ဖုန်း</label>
    <input type="text" id="senderPhone" placeholder="+60XXXXXXXXX" required>
  </div>
  <div class="col">
    <h3>🎯 Receiver Details</h3>
    <label for="receiverName">Receiver Name - လက်ခံသူအမည်</label>
    <input type="text" id="receiverName" placeholder="Enter receiver's full name" required>
    <label for="receiverPhone">Receiver Phone - လက်ခံသူဖုန်း</label>
    <input type="text" id="receiverPhone" placeholder="+95XXXXXXXXX" required>
    <label for="accNumber">Receiver Bank Number - လက်ခံသူဘဏ်နံပါတ်</label>
    <input type="text" id="accNumber" placeholder="Enter account number" required>
  </div>
</div>

<div class="rate-display" id="currentRate"></div>

<div class="transaction-box">
  <div>
    <label for="amount">Amount (MYR)- ပမာဏ (MYR)</label>
    <input type="number" id="amount" placeholder="Enter amount" oninput="calculateTotal()">
  </div>
  <div>
    <label for="charges">Service Charge (MYR)- ဝန်ဆောင်ခ (MYR)</label>
    <input type="text" id="charges" readonly>
  </div>
  <div>
    <label for="total">Total (MYR)- စုစုပေါင်း (MYR)</label>
    <input type="text" id="total" readonly>
  </div>
  <div>
    <label for="mmkAmount">MMK Received- MMK လက်ခံရရှိခြင်း (မြန်မာကျပ်)</label>
    <input type="text" id="mmkAmount" readonly>
  </div>
</div>

<button onclick="submitBank()">Proceed - ရှေ့ဆက်ပါ➡️</button>
</div>

<script>
const SERVICE_CHARGE = 10;
let EXCHANGE_RATE = parseFloat(localStorage.getItem("exchangeRate")) || 520;
document.getElementById("currentRate").textContent = `💱 Current Rate: 1 MYR = ${EXCHANGE_RATE} MMK`;

function calculateTotal() {
  let amount = parseFloat(document.getElementById("amount").value) || 0;
  document.getElementById("charges").value = SERVICE_CHARGE.toFixed(2);
  document.getElementById("total").value = (amount + SERVICE_CHARGE).toFixed(2);
  document.getElementById("mmkAmount").value = (amount * EXCHANGE_RATE).toLocaleString();
}

function showBankLogo() {
  const bank = document.getElementById("bankSelect").value;
  const bankLogo = document.getElementById("bankLogo");
  if(bank==="KBZ Bank") bankLogo.src="https://tinyurl.com/4s36j8we";
  else if(bank==="CB Bank") bankLogo.src="https://www.cbbank.com.mm/sites/cbbank.com.mm/files/cbbank-og-image.jpg";
  else if(bank==="Yoma Bank") bankLogo.src="https://tinyurl.com/36ww4xzw";
  else if(bank==="AYA Bank") bankLogo.src="https://eu-images.contentstack.com/v3/assets/blt7dacf616844cf077/bltc93fa8d8220b8cae/67998a9a458136310bb5e912/AYA-Bank-logo.png?disable=upscale&width=1200&height=630&fit=crop";
  else bankLogo.style.display="none";
  bankLogo.style.display = bank ? "block" : "none";
}

function submitBank() {
  const sender = { name: document.getElementById("senderName").value, phone: document.getElementById("senderPhone").value };
  const receiver = { 
    name: document.getElementById("receiverName").value, 
    phone: document.getElementById("receiverPhone").value, 
    bankNumber: document.getElementById("accNumber").value,
    bank: document.getElementById("bankSelect").value 
  };
  const amount = parseFloat(document.getElementById("amount").value) || 0;

  if(!sender.name || !sender.phone || !receiver.name || !receiver.phone || !receiver.bankNumber || !receiver.bank || amount <= 0){
    alert("⚠️ Please fill all required fields correctly!");
    return;
  }

  const transaction = {
    receiptCode: "RCPT" + Date.now(),
    type: receiver.bank,
    senderName: sender.name,
    senderPhone: sender.phone,
    receiverName: receiver.name,
    receiverPhone: receiver.phone,
    receiverBankNumber: receiver.bankNumber,
    walletType: receiver.bank,
    city: "-",
    amount: amount,
    total: amount + SERVICE_CHARGE,
    mmkAmount: amount * EXCHANGE_RATE,
    status: "In Process",
    date: new Date().toLocaleString()
  };

  // Save transaction for admin panel
  let transactions = JSON.parse(localStorage.getItem("transactions") || "[]");
  transactions.push(transaction);
  localStorage.setItem("transactions", JSON.stringify(transactions));

  // Save last transaction for receipt page
  localStorage.setItem("lastTransaction", JSON.stringify(transaction));

  window.location.href = "receipt.html";
}
</script>
</body>
</html>
